# N8N –§–ª–æ—É –¥–ª—è –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —á–∞—Å—Ç–µ–π –ø–æ—Å—Ç–∞

## –û–ø–∏—Å–∞–Ω–∏–µ
–≠—Ç–æ—Ç —Ñ–ª–æ—É –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —á–∞—Å—Ç–µ–π –ø–æ—Å—Ç–∞ (–∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏–ª–∏ —Ç–µ–∫—Å—Ç–∞) –∫–æ–≥–¥–∞ –∞–¥–º–∏–Ω –Ω–∞–∂–∏–º–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–Ω–æ–ø–∫–∏ –≤ –±–æ—Ç–µ.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–ª–æ—É

### 1. Webhook - Regenerate Part
**–í—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞ —Ñ–ª–æ—É**
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç POST –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ `/regenerate_post_part`
- –û–∂–∏–¥–∞–µ—Ç JSON —Å –¥–∞–Ω–Ω—ã–º–∏:
```json
{
  "action": "regenerate_title" | "regenerate_text",
  "link": "https://original-article-link.com",
  "current_title": "–¢–µ–∫—É—â–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Å—Ç–∞",
  "current_text": "–¢–µ–∫—É—â–∏–π —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞"
}
```

### 2. Check Action Type
**–£—Å–ª–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞** (–ø–æ–∫–∞ —É–ø—Ä–æ—â–µ–Ω–∞, –Ω–æ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∏–ø –¥–µ–π—Å—Ç–≤–∏—è (`regenerate_title` –∏–ª–∏ `regenerate_text`)
- –í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –æ–±–∞ –ø—É—Ç–∏ –≤–µ–¥—É—Ç –∫ –æ–¥–Ω–æ–º—É —Å–∫—Ä–∞–ø–∏–Ω–≥—É

### 3. Scrape Content
**–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Firecrawl API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Å—Ç–∞—Ç—å–∏
- –ü–∞—Ä—Å–∏—Ç –≤ markdown —Ñ–æ—Ä–º–∞—Ç
- –ü–µ—Ä–µ–¥–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ AI

### 4. AI –ê–≥–µ–Ω—Ç—ã –¥–ª—è —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

#### Regenerate Title AI
- –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞
- –£—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Å–æ–∑–¥–∞–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ

#### Regenerate Text AI
- –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –ø–æ—Å—Ç–∞
- –£—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Ç–µ–∫—Å—Ç –∏ —Å–æ–∑–¥–∞–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ

### 5. Process Result (—Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞)
**–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**
- –ü–∞—Ä—Å–∏—Ç –æ—Ç–≤–µ—Ç –æ—Ç AI
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–æ–≤—É—é —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é —á–∞—Å—Ç—å
- –ë–æ—Ç –∂–¥–µ—Ç –æ—Ç–≤–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ (–∫–∞–∫ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ—Å—Ç–∞)

## –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

### –î–ª—è regenerate_title:
```json
{
  "output": "{\"new_title\": \"üö® Bitcoin –Ω–µ –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç: —Å–ª–∞–±—ã–π –æ—Ç—Å–∫–æ–∫ –∏ —É–≥—Ä–æ–∑–∞ –ø–∞–¥–µ–Ω–∏—è –Ω–∏–∂–µ $112K\"}",
  "isValidJson": true
}
```

### –î–ª—è regenerate_text:
```json
{
  "output": "{\"new_text\": \"üí• –ë–∏—Ç–∫–æ–∏–Ω –ø—Ä–æ–≤–∞–ª–∏–ª –ø–æ–ø—ã—Ç–∫—É —Ä–æ—Å—Ç–∞: –æ–±—ä—ë–º—ã —Å–ª–∞–±—ã–µ, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è –º–µ–¥–≤–µ–∂—å–∏. –ñ–¥—ë–º –ø—Ä–æ–±–æ–π $112K –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–µ –ø–∞–¥–µ–Ω–∏–µ üìâ\"}",
  "isValidJson": true
}
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–æ—Ç–æ–º

### –í—ã–∑–æ–≤ –∏–∑ –±–æ—Ç–∞:
```javascript
// –ö–æ–≥–¥–∞ –∞–¥–º–∏–Ω –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫"
const regenerateData = {
  action: "regenerate_title",
  link: selectedPost.originalLink,
  current_title: selectedPost.title,
  current_text: selectedPost.text
};

await fetch('https://your-n8n-instance.com/webhook/regenerate_post_part', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify(regenerateData)
});
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ –≤ –±–æ—Ç–µ:
```javascript
// –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ (–∫–∞–∫ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ—Å—Ç–∞)
const response = await axios.post(n8nUrl, regenerateData);

// –ü–∞—Ä—Å–∏–º –æ—Ç–≤–µ—Ç –æ—Ç N8N (format: {"output": "{\"new_title\": \"...\"}", "isValidJson": true})
let parsedData = null;
if (response.data && response.data.output) {
  try {
    parsedData = JSON.parse(response.data.output);
  } catch (error) {
    console.error('Failed to parse N8N output:', error);
  }
}

if (parsedData && parsedData.new_title) {
  // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –ø–æ—Å—Ç–µ –≤ –ø–∞–º—è—Ç–∏
  selectedPost.trigger_title = parsedData.new_title;
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º UI
  setUserProcessedPost(userId, selectedPost);
  await updatePostMessage(ctx, selectedPost);
} else if (parsedData && parsedData.new_text) {
  // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –ø–æ—Å—Ç–µ –≤ –ø–∞–º—è—Ç–∏
  selectedPost.post_text = parsedData.new_text;
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º UI
  setUserProcessedPost(userId, selectedPost);
  await updatePostMessage(ctx, selectedPost);
}
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π —Ñ–ª–æ—É –≤ N8N
2. –ù–∞—Å—Ç—Ä–æ–π Anthropic API credentials  
3. –û–±–Ω–æ–≤–∏ Firecrawl API –∫–ª—é—á
4. –£–±–µ–¥–∏—Å—å —á—Ç–æ webhook URL –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤ –∫–æ–¥–µ –±–æ—Ç–∞

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ–π —á–∞—Å—Ç–∏ –ø–æ—Å—Ç–∞
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —á–∞—Å—Ç–µ–π –ø–æ—Å—Ç–∞
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏ —Ç–µ–∫—Å—Ç–∞
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ - –ø—Ä–æ—Å—Ç–æ –∂–¥–µ–º –æ—Ç–≤–µ—Ç
- ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö webhook endpoints
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –∏ –Ω–∞–¥–µ–∂–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
